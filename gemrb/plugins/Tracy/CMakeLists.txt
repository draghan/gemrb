IF(STATIC_LINK)
  ADD_LIBRARY(Tracy STATIC ${tracy_SOURCE_DIR}/public/TracyClient.cpp)
ELSE()
  ADD_LIBRARY(Tracy SHARED ${tracy_SOURCE_DIR}/public/TracyClient.cpp)

  IF(WIN32)
    SET_TARGET_PROPERTIES(Tracy PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/gemrb)
    INSTALL(TARGETS Tracy RUNTIME DESTINATION ${LIB_DIR})
  ELSE()
    INSTALL(TARGETS Tracy LIBRARY DESTINATION ${LIB_DIR})
  ENDIF()
ENDIF()

ADD_DEFINITIONS("-DTRACY_ENABLE -DTRACY_DELAYED_INIT")

IF(APPLE)
  SET_TARGET_PROPERTIES(${plugin_name} PROPERTIES PREFIX ""
    LIBRARY_OUTPUT_DIRECTORY
    ${CMAKE_BINARY_DIR}/gemrb/${PROJECT_NAME}.app/Contents/Frameworks)
ELSEIF(MINGW)
  TARGET_LINK_LIBRARIES(Tracy ws2_32 dbghelp)
ENDIF()

